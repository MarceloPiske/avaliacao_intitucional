<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Avaliação CPA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <div id="login-container">
            <h1>Sistema de Avaliação CPA</h1>
            <div id="login-form">
                <div id="login-tabs">
                    <button id="email-tab" class="login-tab active">Email Institucional</button>
                    <button id="code-tab" class="login-tab">Código de Técnicos Administrativo</button>
                </div>
                
                <div id="email-login" class="login-method">
                    <p>Entre com seu email institucional</p>
                    <button id="google-login-button" class="google-btn">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v3/icons/google.svg" alt="Google">
                        Entrar com Google
                    </button>
                    <p class="login-info">Apenas domínios @seminarioconcordia.com.br e @faculdadeluterananconcordia.com.br são aceitos</p>
                </div>
                
                <div id="code-login" class="login-method" style="display: none;">
                    <input type="text" id="staff-code" placeholder="Código de Técnicos Administrativo">
                    <input type="password" id="password" placeholder="Senha">
                    <button id="code-login-button">Entrar</button>
                </div>
                
                <p id="login-error" class="error-message"></p>
            </div>
            <div class="admin-access">
                <a href="admin.html" class="admin-btn">Acessar Painel Administrativo</a>
            </div>
        </div>
        
        <div id="evaluation-container" style="display: none;">
            <header>
                <h1>Avaliação Institucional CPA</h1>
                <div class="user-info">
                    <span id="user-name-display"></span>
                    <button id="eval-logout-button">Sair</button>
                </div>
            </header>
            
            <div class="evaluation-wrapper">
                <div class="evaluation-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progress-current">0</span>/<span id="progress-total">0</span> questões
                    </div>
                </div>
                
                <div id="question-container">
                    <h2 id="question-text"></h2>
                    <div class="rating-container">
                        <div class="rating-options">
                            <label>
                                <input type="radio" name="rating" value="1">
                                <span class="rating-label">1</span>
                            </label>
                            <label>
                                <input type="radio" name="rating" value="2">
                                <span class="rating-label">2</span>
                            </label>
                            <label>
                                <input type="radio" name="rating" value="3">
                                <span class="rating-label">3</span>
                            </label>
                            <label>
                                <input type="radio" name="rating" value="4">
                                <span class="rating-label">4</span>
                            </label>
                            <label>
                                <input type="radio" name="rating" value="5">
                                <span class="rating-label">5</span>
                            </label>
                        </div>
                    </div>
                    <div class="question-navigation">
                        <button id="prev-question" class="secondary">Anterior</button>
                        <button id="next-question">Próxima</button>
                        <button id="submit-evaluation" style="display: none;">Finalizar Avaliação</button>
                    </div>
                </div>
                
                <div id="evaluation-complete" style="display: none;">
                    <div class="success-message">
                        <i class="fas fa-check-circle"></i>
                        <h2>Avaliação Concluída!</h2>
                        <p>Obrigado por participar da avaliação institucional CPA.</p>
                        <p>Suas respostas foram registradas com sucesso.</p>
                        <button id="return-button">Voltar ao Início</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="admin-panel" style="display: none;">
            <header>
                <h1>Painel Administrativo</h1>
                <button id="logout-button">Sair</button>
            </header>
            
            <div class="admin-container">
                <div class="sidebar">
                    <button id="view-dashboard-btn" class="sidebar-btn active">
                        <i class="fas fa-chart-line"></i> Dashboard
                    </button>
                    <button id="view-results-btn" class="sidebar-btn">
                        <i class="fas fa-chart-bar"></i> Resultados
                    </button>
                    <button id="manage-questions-btn" class="sidebar-btn">
                        <i class="fas fa-question-circle"></i> Perguntas
                    </button>
                    <button id="manage-users-btn" class="sidebar-btn">
                        <i class="fas fa-users"></i> Usuários
                    </button>
                    <button id="manage-admins-btn" class="sidebar-btn">
                        <i class="fas fa-user-shield"></i> Administradores
                    </button>
                </div>
                
                <div class="content">
                    <div id="dashboard-section" class="section-content">
                        <h2>Dashboard</h2>
                        
                        <div class="dashboard-tabs">
                            <button class="dashboard-tab active" data-view="overview">Visão Geral</button>
                            <button class="dashboard-tab" data-view="profile">Por Perfil</button>
                            <button class="dashboard-tab" data-view="axis">Por Eixo</button>
                            <button class="dashboard-tab" data-view="dimension">Por Dimensão</button>
                            <button class="dashboard-tab" data-view="trends">Tendências</button>
                            <button class="dashboard-tab" data-view="ranking">Ranking</button>
                        </div>
                        
                        <div class="dashboard-cards">
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3 class="card-title">Total de Respostas</h3>
                                    <div class="card-icon card-bg-blue">
                                        <i class="fas fa-poll"></i>
                                    </div>
                                </div>
                                <p class="card-value" id="total-responses">0</p>
                                <p class="card-label">Respostas coletadas</p>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3 class="card-title">Usuários</h3>
                                    <div class="card-icon card-bg-green">
                                        <i class="fas fa-user-graduate"></i>
                                    </div>
                                </div>
                                <p class="card-value" id="total-users">0</p>
                                <p class="card-label">Usuários cadastrados</p>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3 class="card-title">Participação</h3>
                                    <div class="card-icon card-bg-orange">
                                        <i class="fas fa-percentage"></i>
                                    </div>
                                </div>
                                <p class="card-value" id="participation-rate">0%</p>
                                <p class="card-label">Taxa de participação</p>
                            </div>
                            
                            <div class="dashboard-card">
                                <div class="card-header">
                                    <h3 class="card-title">Avaliação Média</h3>
                                    <div class="card-icon card-bg-purple">
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                                <p class="card-value" id="average-rating">0.0</p>
                                <p class="card-label">Média geral (1-5)</p>
                            </div>
                        </div>
                        
                        <div id="dashboard-overview" class="dashboard-view active">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Participação por Grupo</h3>
                                </div>
                                <div id="participation-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Avaliação por Dimensão</h3>
                                </div>
                                <div id="dimension-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                        
                        <div id="dashboard-profile" class="dashboard-view">
                            <div class="filter-options compact">
                                <div>
                                    <span class="filter-label">Perfil:</span>
                                    <select id="profile-filter">
                                        <option value="alunos">Discentes</option>
                                        <option value="professores">Docentes</option>
                                        <option value="tecnicos">Técnicos Administrativos</option>
                                    </select>
                                </div>
                                <button id="apply-profile-filter" class="secondary">
                                    <i class="fas fa-filter"></i> Aplicar
                                </button>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Respostas por Perfil</h3>
                                </div>
                                <div id="profile-responses-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Média por Dimensão para o Perfil</h3>
                                </div>
                                <div id="profile-dimension-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                        
                        <div id="dashboard-axis" class="dashboard-view">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Perguntas por Eixo</h3>
                                </div>
                                <div id="axis-questions-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Média por Eixo</h3>
                                </div>
                                <div id="axis-average-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                        
                        <div id="dashboard-dimension" class="dashboard-view">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Distribuição de Perguntas por Dimensão</h3>
                                </div>
                                <div id="dimension-distribution-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Média de Satisfação por Dimensão</h3>
                                </div>
                                <div id="dimension-satisfaction-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                        
                        <div id="dashboard-trends" class="dashboard-view">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Evolução da Satisfação ao Longo do Tempo</h3>
                                </div>
                                <div id="trends-satisfaction-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Comparativo entre Períodos</h3>
                                </div>
                                <div id="trends-comparison-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                        
                        <div id="dashboard-ranking" class="dashboard-view">
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Top 5 Questões com Maior Satisfação</h3>
                                </div>
                                <div id="ranking-top-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <div class="chart-header">
                                    <h3 class="chart-title">Top 5 Questões com Menor Satisfação</h3>
                                </div>
                                <div id="ranking-bottom-chart" class="chart-placeholder">
                                    O gráfico será carregado aqui
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="results-section" class="section-content" style="display: none;">
                        <h2>Resultados da Avaliação</h2>
                        
                        <div class="export-options">
                            <div class="export-section">
                                <h3>Exportar Relatório</h3>
                                <div class="export-buttons">
                                    <button id="export-pdf" class="secondary">
                                        <i class="fas fa-file-pdf"></i> PDF
                                    </button>
                                    <button id="export-excel" class="secondary">
                                        <i class="fas fa-file-excel"></i> Excel
                                    </button>
                                </div>
                            </div>
                            
                            <div class="export-settings">
                                <h3>Configurações do Relatório</h3>
                                <div class="export-options-list">
                                    <label>
                                        <input type="checkbox" name="export-option" value="graphs" checked> Incluir Gráficos
                                    </label>
                                    <label>
                                        <input type="checkbox" name="export-option" value="tables" checked> Incluir Tabelas
                                    </label>
                                    <label>
                                        <input type="checkbox" name="export-option" value="summaries" checked> Incluir Resumos
                                    </label>
                                    <label>
                                        <input type="checkbox" name="export-option" value="comments" checked> Incluir Comentários
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="filter-options">
                            <div>
                                <span class="filter-label">Dimensão:</span>
                                <select id="dimension-filter">
                                    <option value="all">Todas as Dimensões</option>
                                </select>
                            </div>
                            <div>
                                <span class="filter-label">Ano:</span>
                                <select id="year-filter">
                                    <option value="all">Todos os Anos</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                </select>
                            </div>
                            <div>
                                <span class="filter-label">Grupo:</span>
                                <select id="group-filter">
                                    <option value="all">Todos os Grupos</option>
                                    <option value="alunos">Discentes</option>
                                    <option value="professores">Docentes</option>
                                    <option value="tecnicos">Técnicos Administrativos</option>
                                </select>
                            </div>
                            <div>
                                <span class="filter-label">Eixo:</span>
                                <select id="axis-filter">
                                    <option value="all">Todos os Eixos</option>
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            <button id="apply-filters" class="secondary">
                                <i class="fas fa-filter"></i> Aplicar Filtros
                            </button>
                        </div>
                        
                        <div id="results-summary" class="results-summary">
                            <!-- Summary information will be displayed here -->
                        </div>
                        
                        <div id="results-container"></div>
                    </div>
                    
                    <div id="questions-section" class="section-content" style="display: none;">
                        <h2>Gerenciar Perguntas</h2>
                        <div class="questions-container">
                            <div class="questions-filter">
                                <div>
                                    <span class="filter-label">Dimensão:</span>
                                    <select id="dimension-select">
                                        <option value="all">Todas as Dimensões</option>
                                    </select>
                                </div>
                                <div>
                                    <span class="filter-label">Grupo:</span>
                                    <select id="group-select">
                                        <option value="all">Todos os Grupos</option>
                                        <option value="alunos">Discentes</option>
                                        <option value="professores">Docentes</option>
                                        <option value="tecnicos">Técnicos Administrativos</option>
                                    </select>
                                </div>
                                <button id="add-question-btn">
                                    <i class="fas fa-plus"></i> Nova Pergunta
                                </button>
                            </div>
                            <div id="questions-list"></div>
                            
                            <div id="question-form-container" style="display: none;">
                                <h3 id="question-form-title">Nova Pergunta</h3>
                                <form id="question-form">
                                    <div class="form-group">
                                        <label for="question-text">Texto da Pergunta:</label>
                                        <textarea id="question-text" required></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label for="question-dimension">Dimensão:</label>
                                        <select id="question-dimension" required>
                                            <option value="">Selecione a Dimensão</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Grupo(s) Aplicável:</label>
                                        <div class="checkbox-group">
                                            <label><input type="checkbox" name="question-group" value="alunos"> Discentes</label>
                                            <label><input type="checkbox" name="question-group" value="professores"> Docentes</label>
                                            <label><input type="checkbox" name="question-group" value="tecnicos"> Técnicos Administrativos</label>
                                        </div>
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" id="save-question-btn">Salvar</button>
                                        <button type="button" id="cancel-question-btn" class="secondary">Cancelar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <div id="users-section" class="section-content" style="display: none;">
                        <h2>Gerenciar Usuários</h2>
                        <div class="users-container">
                            <div class="users-filter">
                                <div>
                                    <span class="filter-label">Buscar:</span>
                                    <input type="text" id="user-search" placeholder="Nome, email...">
                                </div>
                                <div>
                                    <span class="filter-label">Tipo:</span>
                                    <select id="user-type-filter">
                                        <option value="all">Todos os Tipos</option>
                                        <option value="alunos">Discentes</option>
                                        <option value="professores">Docentes</option>
                                        <option value="tecnicos">Técnicos Administrativos</option>
                                    </select>
                                </div>
                                <button id="add-user-btn">
                                    <i class="fas fa-user-plus"></i> Novo Usuário
                                </button>
                            </div>
                            <div id="users-list"></div>
                            
                            <div id="user-form-container" style="display: none;">
                                <h3 id="user-form-title">Novo Usuário</h3>
                                <form id="user-form">
                                    <div class="form-group">
                                        <label for="user-name">Nome:</label>
                                        <input type="text" id="user-name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="user-email">Email:</label>
                                        <input type="email" id="user-email" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="user-type">Tipo de Usuário:</label>
                                        <select id="user-type" required>
                                            <option value="">Selecione o Tipo</option>
                                            <option value="alunos">Aluno</option>
                                            <option value="professores">Professor</option>
                                            <option value="tecnicos">Técnico Administrativo</option>
                                        </select>
                                    </div>
                                    <div id="staff-code-group" class="form-group" style="display: none;">
                                        <label for="user-code">Código de Acesso:</label>
                                        <div style="display: flex; gap: 10px;">
                                            <input type="text" id="user-code" readonly>
                                            <button type="button" id="generate-code-btn" class="secondary">
                                                <i class="fas fa-key"></i> Gerar Código
                                            </button>
                                        </div>
                                    </div>
                                    <div id="user-password-group" class="form-group" style="display: none;">
                                        <label for="user-password">Senha:</label>
                                        <input type="password" id="user-password">
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" id="save-user-btn">Salvar</button>
                                        <button type="button" id="cancel-user-btn" class="secondary">Cancelar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <div id="admins-section" class="section-content" style="display: none;">
                        <h2>Gerenciar Administradores</h2>
                        <div class="users-container">
                            <div class="users-filter">
                                <div>
                                    <span class="filter-label">Buscar:</span>
                                    <input type="text" id="admin-search" placeholder="Nome, email...">
                                </div>
                                <button id="add-admin-btn">
                                    <i class="fas fa-user-shield"></i> Novo Administrador
                                </button>
                            </div>
                            <div id="admins-list"></div>
                            
                            <div id="admin-form-container" style="display: none;">
                                <h3 id="admin-form-title">Novo Administrador</h3>
                                <form id="admin-form">
                                    <div class="form-group">
                                        <label for="admin-name">Nome:</label>
                                        <input type="text" id="admin-name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="admin-email">Email:</label>
                                        <input type="email" id="admin-email" required>
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" id="save-admin-btn">Salvar</button>
                                        <button type="button" id="cancel-admin-btn" class="secondary">Cancelar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- External Libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script type="module" src="app.js"></script>
</body>
</html>